<template>
<Tutorial :pageDescription="description" :pageKeywords="keywords" :innerHtml="tutorialContent" :pageTitle="title"></Tutorial>
</template>
<script lang="ts">
import { Component, Vue } from "nuxt-property-decorator";
import Tutorial from "~/components/tutorial.vue";
@Component({
  components: {
    Tutorial
  }
})
export default class extends Vue {
  tutorialContent = `%3Cp%3EAs%20the%20codes%20written%20in%20Shivneri%20are%20simple%20&amp;%20clean,%20we%20want%20similar%20approach%20for%20test%20cases.%20Let's%20see%20one%20example%20for%20unit%20testing%20%22UserController%22-%20%3C/p%3E%0A%3Cp%3EConsider%20UserController%20implments%20Rest%20Api%20&amp;%20codes%20are%20-%20%3C/p%3E%0A%3Cpre%3E%3Ccode%3Eimport%20%7B%20Controller,%20textResult,%20DefaultWorker,%20jsonResult,%20Worker,%20Route,%20HTTP_STATUS_CODE,%20HTTP_METHOD,%20Guards,%20Singleton%20%7D%20from%20'Shivneri';%0Aimport%20%7B%20UserService%20%7D%20from%20'../services/user_service';%0Aimport%20%7B%20ModelUserGuard%20%7D%20from%20'../guards/model_user_guard';%0Aimport%20%7B%20User%20%7D%20from%20'../models/user';%0A%0Aexport%20class%20UserController%20extends%20Controller%20%7B%0A%0A%20%20%20%20service:%20UserService;%0A%20%20%20%20constructor(@Singleton(UserService)%20service:%20UserService)%20%7B%0A%20%20%20%20%20%20%20%20super();%0A%20%20%20%20%20%20%20%20this.service%20=%20service;%0A%20%20%20%20%7D%0A%0A%20%20%20%20@DefaultWorker()%0A%20%20%20%20async%20getUsers()%20%7B%0A%20%20%20%20%20%20%20%20return%20jsonResult(this.service.getUsers());%0A%20%20%20%20%7D%0A%0A%20%20%20%20@Worker(%5BHTTP_METHOD.Post%5D)%0A%20%20%20%20@Route(%22/%22)%0A%20%20%20%20@Guards(%5BModelUserGuard%5D)%0A%20%20%20%20async%20addUser()%20%7B%0A%20%20%20%20%20%20%20%20const%20user%20=%20this.data.user;%0A%20%20%20%20%20%20%20%20const%20newUser%20=%20this.service.addUser(user);%0A%20%20%20%20%20%20%20%20return%20jsonResult(newUser,%20HTTP_STATUS_CODE.Created);%0A%20%20%20%20%7D%0A%0A%20%20%20%20@Worker(%5BHTTP_METHOD.Put%5D)%0A%20%20%20%20@Route(%22/%22)%0A%20%20%20%20async%20updateUser()%20%7B%0A%20%20%20%20%20%20%20%20const%20user%20=%20new%20User().init(this.body);%0A%20%20%20%20%20%20%20%20const%20userUpdated%20=%20this.service.updateUser(user);%0A%20%20%20%20%20%20%20%20if%20(userUpdated%20===%20true)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20textResult(%22user%20updated%22);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20textResult(%22invalid%20user%22);%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%7D%0A%0A%20%20%20%20@Worker(%5BHTTP_METHOD.Get%5D)%0A%20%20%20%20@Route(%22/%7Bid%7D%22)%0A%20%20%20%20async%20getUser()%20%7B%0A%0A%20%20%20%20%20%20%20%20const%20userId%20=%20Number(this.param.id);%0A%20%20%20%20%20%20%20%20const%20user%20=%20new%20UserService().getUser(userId);%0A%20%20%20%20%20%20%20%20if%20(user%20==%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20textResult(%22invalid%20user%20id%22,%20HTTP_STATUS_CODE.NotFound);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20jsonResult(user);%0A%0A%20%20%20%20%7D%0A%0A%7D%0A%3C/code%3E%3C/pre%3E%0A%3Ch2%20id=%22testcode%22%3ETest%20code%20-%3C/h2%3E%0A%3Cpre%3E%3Ccode%3Edescribe('UserController',%20()%20=&gt;%20%7B%0A%20%20%20%20let%20app,controller;%0A%0A%20%20%20%20beforeAll(async%20()%20=&gt;%20%7B%0A%20%20%20%20%20%20%20%20app%20=%20await%20createApp();%0A%20%20%20%20%20%20%20%20//%20UserController%20has%20dependency%20of%20UserService,%20which%20is%20injected%20by%20Shivneri%20at%20run%20time.%20%0A%20%20%20%20%20%20%20%20//%20Here%20UserService%20is%20a%20fake%20service%20in%20memory%0A%20%20%20%20%20%20%20%20controller%20=%20new%20UserController(new%20UserService());%0A%20%20%20%20%7D);%0A%0A%20%20%20%20it('getUsers',%20async%20()%20=&gt;%20%7B%0A%20%20%20%20%20%20%20%20controller.initialize();%0A%20%20%20%20%20%20%20%20const%20expectedResult%20=%20jsonResult(controller.service.getUsers());%0A%20%20%20%20%20%20%20%20const%20result%20=%20await%20controller.getUsers();%0A%20%20%20%20%20%20%20%20expect(result).toEqual(expectedResult);%0A%20%20%20%20%7D);%0A%0A%20%20%20%20it('addUser',%20async%20()%20=&gt;%20%7B%0A%20%20%20%20%20%20%20%20const%20newUser%20=%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20name:%20'ujjwal%20gupta',%0A%20%20%20%20%20%20%20%20%20%20%20%20emailId:%20'ujjwal@m.com',%0A%20%20%20%20%20%20%20%20%20%20%20%20gender:%20'male',%0A%20%20%20%20%20%20%20%20%20%20%20%20password:%20'asdfvg',%0A%20%20%20%20%20%20%20%20%20%20%20%20address:%20'Bangalore%20India'%0A%20%20%20%20%20%20%20%20%7D;%0A%20%20%20%20%20%20%20%20controller.initialize(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20data:%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user:%20newUser%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20%20%20const%20expectedResult%20=%20jsonResult(newUser,%20201);%0A%20%20%20%20%20%20%20%20const%20result%20=%20await%20controller.addUser();%0A%20%20%20%20%20%20%20%20expect(result).toEqual(expectedResult);%0A%20%20%20%20%20%20%20%20expect(result.responseData).toEqual(newUser);%0A%20%20%20%20%7D);%0A%0A%20%20%20%20it('getUser',%20async%20()%20=&gt;%20%7B%0A%20%20%20%20%20%20%20%20controller.initialize(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20param:%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20id:%20'2'%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20%20%20const%20expectedResult%20=%20jsonResult(controller.service.getUser(2));%0A%20%20%20%20%20%20%20%20const%20result%20=%20await%20controller.getUsers();%0A%20%20%20%20%20%20%20%20expect(result).toEqual(expectedResult);%0A%20%20%20%20%7D);%0A%0A%20%20%20%20it('updateUser',%20async%20()%20=&gt;%20%7B%0A%20%20%20%20%20%20%20%20const%20userData%20=%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20id:%202,%0A%20%20%20%20%20%20%20%20%20%20%20%20name:%20'ujjwal%20gupta',%0A%20%20%20%20%20%20%20%20%20%20%20%20emailId:%20'ujjwal@m.com',%0A%20%20%20%20%20%20%20%20%20%20%20%20gender:%20'male',%0A%20%20%20%20%20%20%20%20%20%20%20%20password:%20'asdfvg',%0A%20%20%20%20%20%20%20%20%20%20%20%20address:%20'Bangalore%20India'%0A%20%20%20%20%20%20%20%20%7D;%0A%0A%20%20%20%20%20%20%20%20//%20update%20user%20for%20existing%20data%0A%20%20%20%20%20%20%20%20controller.initialize(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20body:%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user:%20userData%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20%20%20let%20expectedResult%20=%20await%20textResult(%22user%20updated%22);%0A%20%20%20%20%20%20%20%20let%20result%20=%20await%20controller.updateUser();%0A%20%20%20%20%20%20%20%20expect(result).toEqual(expectedResult);%0A%0A%20%20%20%20%20%20%20%20//%20update%20user%20for%20not%20existing%20data%0A%20%20%20%20%20%20%20%20userData.id%20=%205;%0A%20%20%20%20%20%20%20%20controller.initialize(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20data:%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user:%20userData%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D);%0A%20%20%20%20%20%20%20%20expectedResult%20=%20textResult(%22invalid%20user%22);%0A%20%20%20%20%20%20%20%20result%20=%20await%20controller.updateUser();%0A%20%20%20%20%20%20%20%20expect(result).toEqual(expectedResult);%0A%20%20%20%20%7D);%0A%0A%20%20%20%20afterAll(()%20=&gt;%20%7B%0A%20%20%20%20%20%20%20%20return%20app.destroy();%0A%20%20%20%20%7D);%0A%7D);%0A%3C/code%3E%3C/pre%3E%0A%3Cp%3EIn%20the%20above%20code%20-%3C/p%3E%0A%3Cul%3E%0A%3Cli%3E%3Cp%3E%3Cstrong%3EbeforeAll%3C/strong%3E%20-%20We%20are%20configuring%20everything%20that%20we%20need%20bofore%20test%20starts%20in%20%22beforeAll%22%20hook%20of%20jest%20i.e%20-%20creating%20the%20UserController%20object%20and%20starting%20our%20app.%20The%20hook%20can%20be%20different%20in%20another%20framework.%3C/p%3E%3C/li%3E%0A%3Cli%3E%3Cp%3E%3Cstrong%3EgetUsers%3C/strong%3E%20-%20%20Here%20we%20have%20written%20code%20for%20testing%20getUsers.%20%22getUsers%22%20is%20a%20method%20which%20returns%20all%20the%20user%20presents.%20As%20you%20can%20see,%20the%20first%20line%20of%20the%20code%20is%20'controller.initialize'%20-%20this%20is%20very%20important%20to%20call%20before%20any%20test%20case%20start.%20The%20'initialize'%20method%20is%20present%20in%20every%20component%20i.e%20-%20controller,%20guard,%20wall%20&amp;%20shield.%20This%20is%20used%20to%20initialize%20the%20controller%20with%20some%20value%20i.e%20setting%20body%20object,%20setting%20query%20string%20etc,%20basically%20to%20set%20the%20component%20props.%3C/p%3E%3C/li%3E%0A%3Cli%3E%3Cp%3E%3Cstrong%3EaddUser%3C/strong%3E%20-%20%22addUser%22%20method%20takes%20user%20data%20from%20body%20&amp;%20add%20a%20user.%20We%20are%20using%20'controller.initialize'%20to%20supply%20the%20user%20information%20in%20body.%20But%20in%20code,%20we%20are%20actually%20supplying%20user%20information%20in%20%3Ccode%3Edata%3C/code%3E%20but%20not%20%3Ccode%3Ebody%3C/code%3E%20-%20this%20is%20because%20method%20%22addUser%22%20uses%20a%20Guard%20%3Ccode%3EModelUserGuard%3C/code%3E%20which%20sends%20user%20info%20in%20%3Ccode%3Edata%3C/code%3E%20&amp;%20the%20worker%20%22addUser%22%20uses%20data%20property%20of%20controller.%3C/p%3E%3C/li%3E%0A%3Cli%3E%3Cp%3E%3Cstrong%3EupdateUser%3C/strong%3E%20-%20%20%22updateUser%22%20method%20takes%20user%20data%20from%20body%20&amp;%20update%20user%20if%20exist%20otherwise%20returns%20'invalid%20user'.%20The%20test%20code%20initialise%20the%20controller%20using%20'controller.initialize'%20&amp;%20supply%20the%20user%20information%20in%20body.%20Here%20we%20are%20not%20using%20any%20guard%20(for%20explainining%20how%20to%20pass%20body%20i%20have%20removed%20guard%20from%20this%20method).%3C/p%3E%3C/li%3E%0A%3C/ul%3E%0A%3Cp%3EHope%20this%20is%20clear%20&amp;%20understandable.%20For%20help%20-%20please%20reach%20to%20our%20gitter%20channel.%3C/p%3E`;
  title="Unit Test";
  keywords="test, unit, e2e, Shivneri, crystal";
  description="Setting up unit test in Shivneri";
}
</script>
